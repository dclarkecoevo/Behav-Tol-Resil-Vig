---
title: "Behavioral Tolerance, Vigor, and resilience"
author: "David R. Clark, Jason Walsman, Rachael Kramp, and Jessica Stephenson"
date: "2024-03-25"
output:
  pdf_document:
    toc: yes
    number_sections: yes
  editor_options:
    chunk_output_type: console
  word_document:
    toc: yes
header-includes:
- \usepackage{caption}
- \captionsetup[figure]{labelformat=empty}
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Set so that long lines in R will be wrapped:
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=80), tidy=TRUE)
```

\section{Introduction}

\subsection{Overall summary}

\subsection{Quick experimental summary}

\subsection{Load in packages needed for analysis}

```{r packages and loading in dataset, message=FALSE, warning=FALSE}
#Clear the working environment
rm(list=ls())
#Visualization
library(ggplot2)
library(visreg)
source("http://highstat.com/Books/BGS/GAMM/RCodeP2/HighstatLibV6.R")
#(generalized) Linear mixed modeling
library(lme4)
library(glmmTMB)
library(lmodel2)
#Statistcal analysis reporting and model validation
library(performance)
library(car)
library(lmtest)
library(DHARMa)
#Data wrangling
library(dplyr)
library(plyr)
library(tidyverse)
library(tidylog)

```

\subsection{Load in dataframe}

```{r load in data, warning=FALSE}

#Loading in data set
IndBehav<- read_csv("VIEBehavior_20210913_V2.csv", 
    col_types = cols(fishID = col_character(), 
         Infection = col_character(), InfDate = col_character(), 
         BehavGroup = col_character(), dayofinf = col_character(), 
         CountDay = col_character(), Behavdate = col_character(), 
         TOD = col_character(), Duration=col_double(),Velocity=col_double(),Distance=col_double()))

#Filtering Data set so we can perform our analysis
IndBehav1<-IndBehav %>%
  #Removing columns we dont need
  select(-c(Blind.ID, InfLength, LateLength, dayofinf, Countintial, Notes, InfWeight))

```
\subsection{Calculate metrics needed for further analyses}

\subsubsection{Calculating all body condition metrics}

```{r calculating the body metrics, warning=FALSE}

#####This code is just to examine how many fish cleared their infection (13)####
# IndBehavRec<- IndBehav1 %>%
#   filter(Recov==1)%>%
#   filter(Fish==1)


#####This code is just to examine how many fish died during their infection (2)#####
 # IndBehavDead<- IndBehav1 %>%
 #   filter(Died==1)%>%
 #   filter(Fish==1)

FemaleOnly<-IndBehav1 %>%
  filter(Sex == 'F')
  
MaleOnly<-IndBehav1 %>%
  filter(Sex == 'M')


#Calculating SMI metrics
#####Preinfection SMI#####

#PreinfectionSMI for females
#To calculate the SMI we take the OLS slope 
lmodel2(log(as.numeric(PreWeight)+1)~log(as.numeric(PreLength)+1), data=FemaleOnly)
#Take the median length from summary
summary(FemaleOnly$PreLength)
#Adding PreSMI to Dataframe
FemaleOnly <- FemaleOnly %>%
  group_by(fishID)%>%
  mutate(PreSMI = PreWeight*((20.20/PreLength)^0.4206982))

#PreinfectionSMI for males
lmodel2(log(as.numeric(PreWeight)+1)~log(as.numeric(PreLength)+1), data=MaleOnly)
#Take the median length from summary
summary(MaleOnly$PreLength)
#Adding PreSMI to Dataframe
MaleOnly <- MaleOnly %>%
  group_by(fishID)%>%
  mutate(PreSMI = PreWeight*((15.30/PreLength)^0.1938185))


#####Late Infection SMI####

#Late infection SMI for females
#Take OLS slope from this model
lmodel2(log(as.numeric(LateWeight)+1)~log(as.numeric(PreLength)+1), data=FemaleOnly)
#Take the median length from summary
summary(FemaleOnly$PreLength)
#Adding PreSMI to Dataframe
FemaleOnly <- FemaleOnly %>%
  group_by(fishID)%>%
  mutate(LateSMI = PreWeight*((20.10/PreLength)^-0.5976124))

#Late Infection SMI for males
#Take OLS slope from this model
lmodel2(log(as.numeric(LateWeight)+1)~log(as.numeric(PreLength)+1), data=MaleOnly)
#Take the median length from summary
summary(MaleOnly$PreLength)
#Adding PreSMI to Dataframe
MaleOnly <- MaleOnly %>%
  group_by(fishID)%>%
  mutate(LateSMI = PreWeight*((15.30/PreLength)^-0.472241))
#####

#Bringing the male and female dataframes together to create our overall dataframe
IndBehav2<- rbind(FemaleOnly, MaleOnly)

#View(IndBehav2)
```

\subsubsection{Checking that fish velocity is not different at different times of day.}

We recorded the velocity of the fish at 3 time periods over the course of the day. Once in the monring between 0900-1100, once in the afternoon 1200-1400, 1500-1700. Therefore we wanted to confirm that there is no consistent Time of day effect before we collapse the behavioral measurements into means for each day. 

```{r checking for TOD effect, warning=FALSE}

#####First visually look at the TOD effect for behavior####
ggplot(IndBehav2, aes(TOD,Velocity))+geom_boxplot()+geom_jitter()+xlab("Time of Day")+ylab("Velocity (cm/s)")+theme_classic()

####Verify that this is not statistically significant#####
anova(lm(Velocity~TOD, IndBehav2))

#####Lets also confirm this does not change by sex####
ggplot(IndBehav2, aes(TOD,Velocity, fill=Sex))+geom_boxplot()+geom_jitter()+xlab("Time of Day")+ylab("Velocity (cm/s)")+theme_classic()

#####Lets also confirm this does n0t change by Infection Status####
ggplot(IndBehav2, aes(TOD,Velocity, fill=Infection))+geom_boxplot()+geom_jitter()+xlab("Time of Day")+ylab("Velocity (cm/s)")+theme_classic()

```
Visually there does not seem to be a distinguished pattern overall and an anova confirms it. It also does not seem to visually differ by sex or infection status. Therefore we can collapse the three different time points within a day to a mean velocity and variance of velocity across each time point, Before, Early, Late, and Later.


\subsubsection{Calculating the behavioral tolerance metrics needed for analyses}

We are calculating behavioral tolerance through two metrics. First is a measure of behavioral tolerance using linear mixed models using slope random effects for fishID. This allows us to extract each individuals change in activity with parasite burden and therefore allow us to calculate the tolerance (fishID slope) for each individual. This also allows us to use the random effect intercept for fishID as a measure of behavioral vigor. The second way we could calculate these metrics are a measure of change in behavior between two points of behavior (often referred to as point tolerance, CITATION FOR THIS).  This is calculated in the second half of the code as the change in behavior between pre-infection and early, late, and later points of infection. 

```{r calculating the tolerance metrics, warning=FALSE}

#Calulating the behavioral tolerance metrics were interested in for our analysis

#Random slope from random effects model
#####Random effects model with random slope for each fish by worm burden prior to measuring its activity. This slope is the tolerance an individual has to changing its behavior as infection increases. The slope of the behavior is the individuals behavioral vigor, or its pre-infection behavior#####
BehavTolLM<-lmer(Velocity~(Wormbf|fishID), IndBehav2)
summary(BehavTolLM)
#####Extracting the intercept and slope from the linear mixed model####
betaTol <- data.frame(coef(BehavTolLM)$fishID)
#####Renaming the slope and intercept to align with our metrics#####
betaTol <- betaTol %>%
  rename(BehavTol = Wormbf, BehavVig = X.Intercept.)
#####Creating a fishID column for combination with future dataframe####
betaTol<-cbind(fishID=rownames(betaTol), betaTol)

#Calculating the mean and variance in velocity per day, per fish

#We need to split the dataframes into the differnet time periods to calculate averages since mutate isnt splitting by TrialTime. 

#####creating a dataframe to calculate the mean and variance of velocity for before measurements.#### 

InBehavBefore<- IndBehav2%>%
  drop_na(Velocity)%>%
  filter(TrialTime == "Before")%>%
  select(-c(InfDiff, Fish, Behavdate, Duration, Distance, comp3, Totworm, rate05, rate012,rate512,rate1216,rate18end,TOD,day, linf,maxlinf, maxworm,peakday,Ddate,Rdate, CountDay))%>%
  mutate(AvgVel = mean(Velocity), VarVel = var(Velocity))%>%
  distinct(fishID, .keep_all=TRUE)
  
#####creating a dataframe to calculate the mean and variance of velocity for early measurements.##### 

InBehavEarly<- IndBehav2%>%
  drop_na(Velocity)%>%
  filter(TrialTime == "Early")%>%
  select(-c(InfDiff, Fish, Behavdate, Duration, Distance, comp3, Totworm, rate05, rate012,rate512,rate1216,rate18end,TOD,day, linf,maxlinf, maxworm,peakday,Ddate,Rdate, CountDay))%>%
  mutate(AvgVel = mean(Velocity), VarVel = var(Velocity))%>%
  distinct(fishID, .keep_all=TRUE)


#####creating a dataframe to calculate the mean and variance of velocity for Late measurements. #####

InBehavLate<- IndBehav2%>%
  drop_na(Velocity)%>%
  filter(TrialTime == "Late")%>%
  select(-c(InfDiff, Fish, Behavdate, Duration, Distance, comp3, Totworm, rate05, rate012,rate512,rate1216,rate18end,TOD,day, linf,maxlinf, maxworm,peakday,Ddate,Rdate, CountDay))%>%
  mutate(AvgVel = mean(Velocity), VarVel = var(Velocity))%>%
  distinct(fishID, .keep_all=TRUE)

#####creating a dataframe to calculate the mean and variance of velocity for Later measurements.####

InBehavLater<- IndBehav2%>%
  drop_na(Velocity)%>%
  filter(TrialTime == "Later")%>%
  select(-c(InfDiff, Fish, Behavdate, Duration, Distance, comp3, Totworm, rate05, rate012,rate512,rate1216,rate18end,TOD,day, linf,maxlinf, maxworm,peakday,Ddate,Rdate, CountDay))%>%
  mutate(AvgVel = mean(Velocity), VarVel = var(Velocity))%>%
  distinct(fishID, .keep_all=TRUE)

####Adding these dataframes together to create one large one####

IndBehav3<-rbind(InBehavBefore, InBehavEarly, InBehavLate, InBehavLater)


#####Pivoting wider so I can subtract velocity changes between periods to get change in behavior####
IndBehav4 <- IndBehav3 %>%
  group_by(TrialTime, fishID, add=TRUE)%>%
  select(-Velocity)%>%
  pivot_wider(names_from = TrialTime, values_from = c( Wormbf, Ratebf, AvgVel,VarVel))

#####subset down to infected individuals only and calculate point tolerance metrics for each timeframe. #####
IndBehav4Inf <- IndBehav4 %>%
  group_by(fishID)%>%
  filter(Infection == 1) %>%
  mutate(EChBe = AvgVel_Early - AvgVel_Before,
         LChBe = AvgVel_Late - AvgVel_Before,
         LtrChBe = AvgVel_Later - AvgVel_Before,
         ERatebf = (Wormbf_Early - Wormbf_Before)/6,
         LRatebf = (Wormbf_Late - Wormbf_Early)/6,
         LtrRatebf = (Wormbf_Later - Wormbf_Late)/6
         )%>%
  pivot_longer(cols=starts_with("Wormbf"),
               names_to = "TrialTime",
               names_prefix = "Wormbf_",
               values_to = "Wormbf")%>%
  select(-c(AvgVel_Before, AvgVel_Early, AvgVel_Late, AvgVel_Later, Ratebf_Before,Ratebf_Early,Ratebf_Late,Ratebf_Later))%>%
  filter(fishID != 44)
#####Make two dataframes with pivot longer for wormbf and velocity then merge them together on fishID and TrialTime####
IndBehav4InfV<-IndBehav4 %>%
   filter(Infection == 1) %>%
  pivot_longer(cols = starts_with("AvgVel"),
    names_to = "TrialTime",
    names_prefix = "AvgVel_",
    values_to = "AvgVel"
  )%>%
  select(fishID, AvgVel, TrialTime)%>%
  filter(fishID != 44 )

#####Making the growth rate columns into one column for infected individuals####
IndBehavGRInf <- IndBehav4 %>%
  filter(Infection == 1) %>%
  pivot_longer(cols = starts_with("Ratebf"),
      names_to = "TrialTime",
     names_prefix = "Ratebf_",
     values_to = "Ratebf"
   )%>%
  select(fishID,TrialTime, Ratebf)

#####Making the new growth rate columns into one column for infected individuals#####
IndBehavNGRInf <- IndBehav4Inf %>%
  select(fishID, ERatebf, LRatebf, LtrRatebf)%>%
  rename(NRatebf_Early = ERatebf, NRatebf_Late = LRatebf, NRatebf_Later = LtrRatebf)%>%
  add_column(NRatebf_Before = 0)%>%
  pivot_longer(cols = starts_with("NRatebf"),
      names_to = "TrialTime",
     names_prefix = "NRatebf_",
     values_to = "NRatebf"
   )%>%
  select(fishID,TrialTime, NRatebf)%>%
  distinct(fishID,TrialTime, .keep_all=TRUE)

#####Making the Variance columns into one column for infected individuals#####
IndBehavVarInf <- IndBehav4Inf %>%
  select(-TrialTime)%>%
  pivot_longer(cols = starts_with("VarVel"),
      names_to = "TrialTime",
     names_prefix = "VarVel_",
     values_to = "VarVel"
   )%>%
  select(fishID,TrialTime, VarVel)%>%
  distinct(fishID,TrialTime, .keep_all=TRUE)


#####Merging the tolerance and vigor metrics ####
IndBehav4Inf1<-merge(IndBehav4Inf, betaTol, by.x="fishID", by.y = "fishID")

#####Merge the two dataframes together based on the fishID and TrialTime to get all variables we want into one dataframe#####
IndBehav5Inf<-merge(IndBehav4InfV, IndBehav4Inf1, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Inf2<-merge(IndBehav5Inf, IndBehavGRInf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Inf3<-merge(IndBehav5Inf2, IndBehavNGRInf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Inf4<-merge(IndBehav5Inf3, IndBehavVarInf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
#Subset down to uninfected individuals and calculate their point tolerance metrics
#####Creating a dataframe for calculating the tolerance metrics and then pivot longer by Wormbf####
IndBehav4Unf <- IndBehav4 %>%
  filter(Infection == 0)%>%
  mutate(EChBe = AvgVel_Early - AvgVel_Before,
         LChBe = AvgVel_Late - AvgVel_Before,
         LtrChBe = AvgVel_Later - AvgVel_Before,
         NRatebf_Early = (Wormbf_Early - Wormbf_Before)/5,
         NRatebf_Late = (Wormbf_Late - Wormbf_Early)/5,
         NRatebf_Later = (Wormbf_Later - Wormbf_Late)/5,
         )%>%
  group_by(fishID)%>%
  pivot_longer(cols = starts_with(c("Wormbf")),
      names_to = "TrialTime",
     names_prefix = c("Wormbf_"),
     values_to="Wormbf"
   )%>%
  select(-c(AvgVel_Before, AvgVel_Early, AvgVel_Late, AvgVel_Later, Ratebf_Before,Ratebf_Early,Ratebf_Late,Ratebf_Later))


#####Creating a second dataframe where we pivot longer for velocity####
IndBehav4UnfV <- IndBehav4 %>%
  filter(Infection == 0)%>%
  pivot_longer(cols = starts_with("AvgVel"),
  names_to = "TrialTime",
  names_prefix = "AvgVel_",
  values_to = "AvgVel"
  )%>%
  select(fishID, TrialTime, AvgVel)


#####Making the growth rate columns into one column for uninfected individuals#####
IndBehavGRUnf <- IndBehav4 %>%
  filter(Infection == 0) %>%
  pivot_longer(cols = starts_with("Ratebf"),
      names_to = "TrialTime",
     names_prefix = "Ratebf_",
     values_to = "Ratebf"
   )%>%
  select(fishID,TrialTime, Ratebf)

#####Making the new growth rate columns into one column for infected individuals#####
IndBehavNGRUnf <- IndBehav4Unf %>%
  select(-TrialTime)%>%
  add_column(NRatebf_Before = 0)%>%
  pivot_longer(cols = starts_with("NRatebf"),
      names_to = "TrialTime",
     names_prefix = "NRatebf_",
     values_to = "NRatebf"
   )%>%
  select(fishID,TrialTime, NRatebf)%>%
  distinct(fishID,TrialTime, .keep_all=TRUE)

#####Making the Variance columns into one column for infected individuals#####
IndBehavVarUnf <- IndBehav4Unf %>%
  select(-TrialTime)%>%
  pivot_longer(cols = starts_with("VarVel"),
      names_to = "TrialTime",
     names_prefix = "VarVel_",
     values_to = "VarVel"
   )%>%
  select(fishID,TrialTime, VarVel)%>%
  distinct(fishID,TrialTime, .keep_all=TRUE)

#####Merge the different datasets together#####
IndBehav5Unf<-merge(IndBehav4UnfV, IndBehav4Unf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Unf2<-merge(IndBehav5Unf, IndBehavGRUnf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Unf3<-merge(IndBehav5Unf2, IndBehavNGRUnf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
IndBehav5Unf4<-merge(IndBehav5Unf3, IndBehavVarUnf, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)

#Creating the BehavTol and BehavVig columns for the uninfected and calculating the metric for uninfected individual so we can combine these dataframes together
IndBehav5Unf4 <- IndBehav5Unf4 %>%
  group_by(fishID)%>%
  add_column(BehavTol=0, BehavVig=0)


#Rbinding our infected and uninfected dataframes together into one overall dataframe
IndBehav5<-rbind(IndBehav5Unf4,IndBehav5Inf4)

##Pivot longer for Change in behavior 
IndBehav5ChBe <- IndBehav5%>%
  select(-TrialTime)%>%
  rename(ChBehav_Early=EChBe, ChBehav_Late = LChBe, ChBehav_Later = LtrChBe)%>%
  add_column(ChBehav_Before = 0)%>%
  pivot_longer(cols = starts_with("ChBehav"),
      names_to = "TrialTime",
     names_prefix = "ChBehav_",
     values_to = "ChBehav"
    )%>%
  select(fishID, TrialTime, ChBehav)%>%
  distinct(fishID,TrialTime, .keep_all=TRUE)

#Merge dataframes together for one large dataframe
IndBehav6<-merge(IndBehav5, IndBehav5ChBe, by.x=c("fishID", "TrialTime"), by.y=c("fishID", "TrialTime"), all=TRUE)
#Removing some of the columns we dont want in the dataframe
IndBehav6<- IndBehav6%>% 
  select(-c(ERatebf,LRatebf,LtrRatebf, NRatebf_Early,NRatebf_Late,NRatebf_Later, VarVel_Before,VarVel_Early, VarVel_Late, VarVel_Later))



#Create a point tolerance metric for each timepoint
IndBehav6 <- IndBehav6%>%
  mutate(PTol = ChBehav/Wormbf)%>%
  select(-c(EChBe,LChBe,LtrChBe))

#Remove dataframes used for data wrangling and managing
# rm(c(IndBehav, IndBehav1,IndBehav2,IndBehav3,IndBehav3Inf1,IndBehav4,IndBehav4Inf,IndBehav4Inf1,IndBehav4InfV,IndBehav4Unf,IndBehav4UnfV,IndBehav5,IndBehav52,IndBehav5ChBe,IndBehav5Inf,IndBehav5Inf2,IndBehav5Inf3,IndBehav5Inf4,IndBehavVarUnf,IndBehavVarInf,IndBehavNGRUnf,IndBehavNGRInf,IndBehavGRUnf,IndBehav5Unf4,IndBehav5Unf3,IndBehav5Unf2,IndBehav5Unf))

#Setting some characters as factors
IndBehav6$TrialTime<-as.factor(IndBehav6$TrialTime)
IndBehav6$Sex<-as.factor(IndBehav6$Sex)
IndBehav6$Infection<-as.factor(IndBehav6$Infection)
IndBehav6$Recov<-as.factor(IndBehav6$Recov)
IndBehav6$Died<-as.factor(IndBehav6$Died)
IndBehav6$Treatment<-as.factor(IndBehav6$Treatment)
IndBehav6$RecovPeriod<-as.factor(IndBehav6$RecovPeriod)

#Getting a summary of the entire dataframe
summary(IndBehav6)
```

Now we have to decided how best to calculate whether an individual has recovered. In the experiment only had 13 fish recover from infection totally, therefore we are thinking of another metric that indicates a fish is in recovery during infection. 

\subsection{Description of data, structure, and type}

\textbf{fishID}: The individual ID of each fish used in the trial. \newline
\textbf{TrialTime}: The point of infection where each behavior trial happened. Early - early infection (6 days), Late - late in infection (12 days), Later - later in infection (18 days)\newline
\textbf{AvgVel}: The average velocity from three separate behavioral trials of each fish for each of the Trial Times. ($cm/s$) \newline
\textbf{Sex}: The sex of the individual. F - female, M - male \newline
\textbf{PreWeight}: The weight of the individual prior to their fist behavior trial and pre-infection. ($grams$)  \newline
\textbf{PreLength}: The length of the individual prior to their first behavior trial and pre-infection ($mm$) \newline
\textbf{Treatment}: What treatment the fish received prior to their first behavior and pre-infection. VIE - visible implant elastomer implant, UNTOUCHED - control individual, received no injection nor implant ($mm$) \newline
\textbf{Infection}: Whether or not the individual was infected with Gyrodactylus turnbulli. 1 - infected, 0 - uninfected \newline
\textbf{LateWeight}: The weight of the individual after their final behavior trial and after infection. ($grams$) \newline
\textbf{wormJump}: The number of worms that jumped from the donor fish to the trial fish during manual infections. \newline
\textbf{AUC2}: The area under the curve of infection over the total infection trajectory for each individual. \newline
\textbf{RecovPeriod}: The time frame in which an individual started recovering from infection. This is calculated by looking at the growth rate of the worms between each count and see when the worm growth rate was decreasing overall. \newline
\textbf{Recov}: Whether or not the individual recovered from infection during the experimental trial. 1 - recovered, 0 - did not recover \newline
\textbf{Died}: Whether or not the individual Died from infection during the experimental trial. 1 - Died, 0 - did not died \newline
\textbf{PreSMI}: The body condition of the individual prior to their first behavioral trial and pre infection. ($mm/g$) \newline
\textbf{LateSMI}: The body condition of the individual after to their last behavioral trial and after infection. ($mm/g$) \newline
\textbf{Wormbf}:The number of worms on the fish prior to each trial. \newline
\textbf{Ratebf}:The rate of growth of worms on the fish prior to each trial from the worm count immediately prior to the trial. \newline
\textbf{NRatebf}:The rate of growth of worms on the fish prior to each trial calculated as the change in worms between each time point. (For Example, From before to early). \newline
\textbf{VarVel}:The variance in velocity from the separate behavioral trials during each time point. ($(cm/s)^2$) \newline
\textbf{BehavTol}:The behavioral tolerance of each individual calculated as the slope of a random effect model where fishID is the random effect term.  \newline
\textbf{BehavVig}:The behavioral Vigor of each individual calculated as the intercept of a random effect model where fishID is the random effect term \newline
\textbf{ChBehav}:The change in behavior between trial times. ($cm/s$) \newline
\textbf{PTol}:Point tolerance metric calculated by dividing the change in behavior between time points by the worms on the fish before the trial ($cm/s/worms$) \newline


```{r primary visualization for our variables for analysis, warning=FALSE}

pairs(~AvgVel+TrialTime+Sex+Treatment+Infection+LateWeight+AUC2+Recov+Died+PreSMI+LateSMI+Wormbf+Ratebf+NRatebf+VarVel+BehavTol+BehavVig+ChBehav+PTol, lower.panel=panel.smooth, diag.panel=panel.hist, 
upper.panel=panel.cor, data=IndBehav6)

```

